<!-- Navigation Bar with Hamburger Menu -->
<div data-controller="drawer theme">
  <!-- Top Navbar -->
  <nav class="navbar">
    <div class="navbar-content">
      <!-- Left: Hamburger (mobile only) + Logo + Desktop Nav Links -->
      <div class="navbar-left">
        <% if user_signed_in? %>
          <button 
            class="hamburger-button" 
            data-action="click->drawer#toggle"
            aria-label="Toggle menu">
            <span class="hamburger-icon">â˜°</span>
          </button>
        <% end %>
        <%= link_to home_path, class: "navbar-logo" do %>
          <span class="navbar-logo-up">UP</span>
          <span class="navbar-logo-separator">|</span>
          <span class="navbar-logo-text">Competitive Programming Platform</span>
        <% end %>
        
        <!-- Desktop Navigation Links (hidden on mobile) -->
        <% if user_signed_in? %>
          <div class="navbar-desktop-links">
            <%= link_to t('navigation.problems'), problems_path, class: "navbar-link" %>
            <%= link_to t('navigation.submissions'), submission_path, class: "navbar-link" %>
            <%= link_to t('navigation.contests'), contests_path, class: "navbar-link" %>
          </div>
        <% end %>
      </div>
      
      <!-- Right: User Menu + Language Switcher + Theme Toggle (desktop only) -->
      <div class="navbar-right">
        <%= render 'shared/language_switcher' %>
        
        <button 
          class="theme-toggle-button navbar-desktop-only" 
          data-action="click->theme#toggle"
          data-theme-target="icon"
          title="Toggle theme">
          ğŸŒ™
        </button>
        
        <% if user_signed_in? %>
          <%= link_to user_path(alias: current_user.alias), class: "user-menu-link navbar-desktop-only" do %>
            <div class="user-menu">
              <div class="user-avatar">
                <%= current_user.alias[0..1].upcase %>
              </div>
              <span class="user-name"><%= current_user.alias %></span>
            </div>
          <% end %>
        <% end %>
      </div>
    </div>
  </nav>
  
  <% if user_signed_in? %>
    <!-- Overlay (backdrop) -->
    <div 
      class="drawer-overlay" 
      data-drawer-target="overlay"
      data-action="click->drawer#closeOnOverlay">
    </div>
    
    <!-- Side Drawer (mobile only) -->
    <aside class="drawer" data-drawer-target="drawer">
      <div class="drawer-header">
        <h2 class="drawer-title"><%= t('navigation.menu') %></h2>
        <button 
          class="drawer-close" 
          data-action="click->drawer#close"
          aria-label="Close menu">
          âœ•
        </button>
      </div>
      
      <nav class="drawer-nav">
        <!-- Profile Section (mobile only) -->
        <%= link_to user_path(alias: current_user.alias), class: "drawer-link drawer-profile-link" do %>
          <div class="drawer-user-avatar">
            <%= current_user.alias[0..1].upcase %>
          </div>
          <div class="drawer-user-info">
            <span class="drawer-user-name"><%= current_user.alias %></span>
            <span class="drawer-user-label"><%= t('navigation.view_profile') %></span>
          </div>
        <% end %>
        
        <div class="drawer-divider"></div>
        
        <%= link_to problems_path, class: "drawer-link" do %>
          <span class="drawer-icon">ğŸ“</span>
          <span><%= t('navigation.problems') %></span>
        <% end %>
        
        <%= link_to submission_path, class: "drawer-link" do %>
          <span class="drawer-icon">ğŸ“Š</span>
          <span><%= t('navigation.submissions') %></span>
        <% end %>
        
        <%= link_to contests_path, class: "drawer-link" do %>
          <span class="drawer-icon">ğŸ†</span>
          <span><%= t('navigation.contests') %></span>
        <% end %>
        
        <div class="drawer-divider"></div>
        
        <!-- Language Switcher (mobile) -->
        <div class="drawer-language-section">
          <div class="drawer-section-title">Language / Idioma</div>
          <% if I18n.locale == :en %>
            <%= form_with url: switch_locale_path(:es), method: :post, class: "language-form-mobile" do %>
              <button type="submit" class="drawer-language-button active">
                <span class="flag-icon-large">ğŸ‡¦ğŸ‡·</span>
                <span>Cambiar a EspaÃ±ol</span>
              </button>
            <% end %>
          <% else %>
            <%= form_with url: switch_locale_path(:en), method: :post, class: "language-form-mobile" do %>
              <button type="submit" class="drawer-language-button active">
                <span class="flag-icon-large">ğŸ‡ºğŸ‡¸</span>
                <span>Switch to English</span>
              </button>
            <% end %>
          <% end %>
        </div>
        
        <div class="drawer-divider"></div>
        
        <!-- Theme Toggle (mobile only) -->
        <button 
          class="drawer-link drawer-theme-toggle" 
          data-action="click->theme#toggle"
          title="Toggle theme">
          <span class="drawer-icon" data-theme-target="icon">ğŸŒ™</span>
          <span><%= t('navigation.toggle_theme') %></span>
        </button>
        
        <%= link_to destroy_user_session_path, data: { "turbo-method": :delete }, class: "drawer-link drawer-link-danger" do %>
          <span class="drawer-icon">ğŸšª</span>
          <span><%= t('navigation.sign_out') %></span>
        <% end %>
      </nav>
    </aside>
  <% end %>
</div>

