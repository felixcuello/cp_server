<div class="page-container submissions-page">
  <!-- Header -->
  <div class="submissions-header">
    <h1 class="page-title"><%= @show_all ? t('submissions.all_submissions') : t('submissions.title') %></h1>
    <div class="header-actions">
      <% if @show_all %>
        <%= link_to submission_path, class: "toggle-view-btn" do %>
          <span>ğŸ‘¤</span>
          <span><%= t('submissions.my_submissions_btn') %></span>
        <% end %>
      <% else %>
        <%= link_to submission_path(show_all: 'true'), class: "toggle-view-btn" do %>
          <span>ğŸ‘¥</span>
          <span><%= t('submissions.all_users') %></span>
        <% end %>
      <% end %>
    </div>
  </div>

  <!-- Submissions List -->
  <div class="submissions-list">
    <% if @submissions.any? %>
      <% @submissions.each do |submission| %>
        <div class="submission-card"
             onclick="window.location='<%= submission_detail_path(submission) %>'"
             data-controller="submission-status"
             data-submission-status-id-value="<%= submission.id %>"
             data-submission-status-current-value="<%= submission.status %>">
          
          <!-- Top Row: Problem + Status -->
          <div class="submission-card-header">
            <div class="submission-problem-info">
              <span class="problem-number">#<%= submission.problem.id %></span>
              <%= link_to submission.problem.title, problem_path(submission.problem), class: "problem-title-link", data: { turbo: false } %>
              <% if submission.contest %>
                <span class="contest-badge-small" title="<%= t('problem.contest') %>: <%= submission.contest.name %>">
                  ğŸ† <%= t('submissions.contest_badge') %>
                </span>
              <% end %>
            </div>
            <div class="submission-status-badge <%= submission.status.downcase.gsub(/\s+/, '-') %>">
              <%= status_icon(submission.status) %>
              <span><%= submission.status.titleize %></span>
            </div>
          </div>

          <!-- Bottom Row: Meta info -->
          <div class="submission-card-footer">
            <div class="submission-meta">
              <span class="meta-item">
                <span class="meta-icon">ğŸ‘¤</span>
                <%= link_to submission.user.alias, user_path(alias: submission.user.alias), class: "user-link", onclick: "event.stopPropagation();" %>
              </span>
              <span class="meta-item">
                <span class="meta-icon">ğŸ’»</span>
                <span class="language-name"><%= submission.programming_language.name %></span>
              </span>
              <span class="meta-item">
                <span class="meta-icon">â±ï¸</span>
                <span class="time-text"><%= time_ago_in_words(submission.created_at) %> <%= t('submissions.ago') %></span>
              </span>
              <% if submission.time_used %>
                <span class="meta-item">
                  <span class="meta-icon">âš¡</span>
                  <span class="runtime-text"><%= (submission.time_used * 1000).round %> <%= t('submissions.ms') %></span>
                </span>
              <% end %>
            </div>
          </div>
        </div>
      <% end %>
    <% else %>
      <div class="empty-state">
        <div class="empty-icon">ğŸ“</div>
        <div class="empty-title"><%= t('submissions.no_submissions') %></div>
        <div class="empty-text"><%= t('submissions.no_submissions_text') %></div>
      </div>
    <% end %>
  </div>

  <!-- Pagination -->
  <% if @total_pages > 1 %>
    <div class="pagination-container">
      <% if @page > 1 %>
        <%= link_to submission_path(show_all: @show_all ? 'true' : nil, page: @page - 1), class: "pagination-btn" do %>
          <span>â† <%= t('submissions.previous') %></span>
        <% end %>
      <% else %>
        <span class="pagination-btn disabled">â† <%= t('submissions.previous') %></span>
      <% end %>

      <div class="pagination-info">
        <%= t('submissions.page') %> <strong><%= @page %></strong> <%= t('submissions.of') %> <strong><%= @total_pages %></strong>
      </div>

      <% if @page < @total_pages %>
        <%= link_to submission_path(show_all: @show_all ? 'true' : nil, page: @page + 1), class: "pagination-btn" do %>
          <span><%= t('submissions.next') %> â†’</span>
        <% end %>
      <% else %>
        <span class="pagination-btn disabled"><%= t('submissions.next') %> â†’</span>
      <% end %>
    </div>
  <% end %>
</div>
